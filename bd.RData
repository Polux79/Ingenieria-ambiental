
Bdf <- readXL("D:/Users/Henry Azula/Documents/UNIVERSIDAD CATÃ“LICA SEDES SAPIENTIAE/TESIS/EMMA HUAMAN/bd.xlsx", 
  rownames=TRUE, header=TRUE, na="", sheet="Hoja1", stringsAsFactors=TRUE)
summary(Bdf)
Bdf <- within(Bdf, {
  Cadmio <- as.factor(Cadmio)
})
summary(Bdf)
Bdf <- within(Bdf, {
  Compost <- as.factor(Compost)
})
summary(Bdf)
Bdf <- within(Bdf, {
  HMA <- as.factor(HMA)
})
summary(Bdf)
LinearModel.1 <- lm(Colonizacion ~ HMA +Cadmio +Compost +HMA :Cadmio +HMA :Compost +Cadmio :Compost +HMA :Cadmio :Compost, data=Bdf)
summary(LinearModel.1)
AIC(LinearModel.1)
Tapply(Colonizacion ~ Cadmio, median, na.action=na.omit, data=Bdf) # medians by group
Tapply(Colonizacion ~ Compost, median, na.action=na.omit, data=Bdf) # medians by group
Tapply(Colonizacion ~ HMA, median, na.action=na.omit, data=Bdf) # medians by group
kruskal.test(Colonizacion ~ Cadmio, data=Bdf)
kruskal.test(Colonizacion ~ Compost, data=Bdf)
kruskal.test(Colonizacion ~ HMA, data=Bdf)
AnovaModel.3 <- lm(Colonizacion ~ Cadmio*Compost*HMA, data=Bdf, contrasts=list(Cadmio ="contr.Sum", Compost ="contr.Sum", HMA ="contr.Sum"))
Anova(AnovaModel.3)
Tapply(Colonizacion ~ Cadmio + Compost + HMA, mean, na.action=na.omit, data=Bdf) # means
Tapply(Colonizacion ~ Cadmio + Compost + HMA, sd, na.action=na.omit, data=Bdf) # std. deviations
xtabs(~ Cadmio + Compost + HMA, data=Bdf) # counts
Anova(AnovaModel.3, type="II")
summarySandwich(AnovaModel.3, type="hc3")
library(leaps, pos=20)
plot(regsubsets(Colonizacion ~ Cadmio * Compost * HMA, data=Bdf, nbest=1, nvmax=8), scale='r2')
Anova(LinearModel.1, type="II")
Anova(LinearModel.1, type="II")

